<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <title>Apple Music & Podcast Cover Downloader</title>  
    <style>  
        /* 基本页面样式 */  
        body {  
            font-family: Arial, sans-serif;  
            max-width: 800px;  
            margin: 0 auto;  
            padding: 20px;  
            text-align: center;  
        }  
        h1 {  
            color: #333;  
            margin-bottom: 30px;  
        }  
        /* 搜索输入框样式 */  
        #search-container {  
            margin-bottom: 30px;  
            width: 100%;  
        }  
        #search-input {  
            width: 100%;  
            padding: 12px;  
            font-size: 16px;  
            border: 2px solid #ddd;  
            outline: none;  
            transition: border-color 0.3s;  
            box-sizing: border-box;  
        }  
        #search-input:focus {  
            border-color: #007AFF;  
        }  
        /* 搜索结果网格布局 */  
        #results {  
            display: grid;  
            grid-template-columns: repeat(4, 1fr);  
            gap: 15px;  
            width: 100%;  
        }  
        /* 封面图样式 */  
        .cover {  
            cursor: pointer;  
            transition: transform 0.2s;  
            position: relative;  
            overflow: hidden;  
            aspect-ratio: 1 / 1;  
        }  
        .cover:hover {  
            transform: scale(1.05);  
        }  
        .cover img {  
            width: 100%;  
            height: 100%;  
            display: block;  
            object-fit: cover;  
        }  
        /* 封面信息样式 */  
        .cover-info {  
            padding: 10px;  
            text-align: left;  
            background-color: rgba(0, 0, 0, 0.7);  
            position: absolute;  
            bottom: 0;  
            left: 0;  
            right: 0;  
            transition: opacity 0.3s;  
            opacity: 0;  
            color: white;  
        }  
        .cover:hover .cover-info {  
            opacity: 1;  
        }  
        .album-name, .artist-name {  
            white-space: nowrap;  
            overflow: hidden;  
            text-overflow: ellipsis;  
        }  
        .album-name {  
            font-weight: bold;  
            font-size: 0.9em;  
            margin-bottom: 2px;  
        }  
        .artist-name {  
            font-size: 0.8em;  
            color: #ccc;  
        }  
    </style>  
</head>  
<body>  
    <h1>Apple Music & Podcast Cover Downloader</h1>  
    <div id="search-container">  
        <input type="text" id="search-input" placeholder="Enter album or podcast name">  
    </div>  
    <div id="results"></div>  

    <script>  
        // 获取DOM元素  
        const searchInput = document.getElementById('search-input');  
        const resultsContainer = document.getElementById('results');  
        let debounceTimer;  

        // 为搜索输入框添加输入事件监听器  
        searchInput.addEventListener('input', () => {  
            clearTimeout(debounceTimer);  
            debounceTimer = setTimeout(search, 300); // 300ms延迟，实现防抖  
        });  

        // 搜索函数  
        function search() {  
            const query = searchInput.value;  
            if (query.length < 2) {  
                resultsContainer.innerHTML = '';  
                return;  
            }  

            // 构建iTunes API搜索URL  
            const url = `https://itunes.apple.com/search?term=${encodeURIComponent(query)}&media=music,podcast&entity=album,podcast`;  

            // 发送API请求  
            fetch(url)  
                .then(response => response.json())  
                .then(data => {  
                    resultsContainer.innerHTML = '';  
                    // 遍历搜索结果并创建封面元素  
                    data.results.forEach(item => {  
                        const coverUrl = item.artworkUrl100.replace('100x100', '600x600');  
                        const div = document.createElement('div');  
                        div.className = 'cover';  
                        
                        const img = document.createElement('img');  
                        img.src = coverUrl;  
                        img.alt = item.collectionName || item.trackName;  
                        
                        const infoDiv = document.createElement('div');  
                        infoDiv.className = 'cover-info';  

                        const albumName = document.createElement('div');  
                        albumName.className = 'album-name';  
                        albumName.textContent = item.collectionName || item.trackName;  

                        const artistName = document.createElement('div');  
                        artistName.className = 'artist-name';  
                        artistName.textContent = item.artistName;  
                        
                        infoDiv.appendChild(albumName);  
                        infoDiv.appendChild(artistName);  
                        
                        div.appendChild(img);  
                        div.appendChild(infoDiv);  
                        // 为封面添加点击事件，触发下载  
                        div.addEventListener('click', () => downloadCover(coverUrl, item.collectionName || item.trackName));  
                        resultsContainer.appendChild(div);  
                    });  
                })  
                .catch(error => console.error('Error:', error));  
        }  

        // 下载封面图片函数  
        function downloadCover(url, name) {  
            fetch(url)  
                .then(response => response.blob())  
                .then(blob => {  
                    const link = document.createElement('a');  
                    link.href = URL.createObjectURL(blob);  
                    link.download = `${name.replace(/[^a-z0-9]/gi, '_').toLowerCase()}_cover.jpg`;  
                    document.body.appendChild(link);  
                    link.click();  
                    document.body.removeChild(link);  
                })  
                .catch(error => console.error('Download error:', error));  
        }  
    </script>  
</body>  
</html>